ggplot2把进行数据映射分成了三个阶段：
- 第一阶段，**拿到数据之后**,最初阶段，拿到用户提供的数据，映射给图形元素
- 第二阶段，**统计变换之后**，数据完成转化或者统计计算之后，再映射给图形元素
- 第三阶段，**图形标度之后**，数据完成标度配置之后，映射给图形元素，在最后渲染出图之前

延迟到**统计变换**之后的例子是，在geom_histogram()画柱状图的时候， 柱子的高度并不直接来源用户提供的数据，而是来源于stat_bin()函数统计计算后的结果

延迟到**图形标度**之后的例子是，geom_bar()画柱子图，定义了柱子的颜色后，想在颜色的基础上增加点透明度，作为柱子的填充色。

如果不是直接使用原始数据，而是用统计变换后的数据来映射，就需要使用after_stat(),函数告诉ggplot2等到统计变换完成后再做美学映射。如果想在完成标度配置之后，再映射给图形元素，就需要使用after_scale()函数。如果多次映射图形元素，比如变量 x 先传递给统计函数，然后把统计结果映射给图形元素，就需要使用 stage(start = NULL, after_stat = NULL, after_scale = NULL) 控制每一个过程